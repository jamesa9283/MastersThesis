% !TEX root = ../../thesis.tex

\section{Rotating Stratified Fluid}
We finally aim to derive the Euler equations for a rotating stratified fluid. This example opens up the possibilities of using this mathematics in geophysical fluid dynamics. What we will derive will be a simple model for storms, clouds and other objects in the atmosphere that have variable density, are buoyant in fluid and are affected by the Coriolis force. We will follow a similar procedure to the example after the advected quantity theorem. We can take the Lagrangian,
$$ L = \int_M \left[ \rho (1 + b)\left( \frac{1}{2}|\dot\eta^2| + \dot \eta \cdot \vec R - gz \right) - p(\rho - 1) \right]. $$
We can now reduce this to the following reduced Lagrangian, much like the compressible fluid example.
$$ \ell(\vec u,\, D,\, b) = \int_M \left[ \rho_0(1 + b)D \left( \frac{1}{2}|\vec u|^2 + \vec u \cdot \vec R - gz \right) - p(D-1) \right]. $$
To deal with more conserved quantities, the Euler-Poincar\'e equations become,
\begin{equation}
  \pdt \fd \ell \xi = -\ad^*_\xi \pd \ell \xi + \pd \ell a \diamond a + \pd \ell b \diamond b,\label{eq:ep_ad_two}
\end{equation}
where $a$ and $b$ are advected quantities. These advected quantities satisfy,
$$ \left( \pdt + \pounds_{\vec u} \right)a = \left( \pdt + \pounds_{\vec u} \right)b = 0. $$
\noindent
We can now find the variational derivatives. By performing the calculations, we arrive at the following.
\begin{align*}
  \ip{\fd \ell {\vec u}}{\phi} &= \ip{\rho_0 D (1 + b)(\vec u^\flat + \vec R )}{\phi} \\
  \ip{\fd \ell b}{\phi} &= \ip{\rho_0 D \left( \frac{1}{2}|\vec u^\flat|^2 + \vec u \cdot \vec R - gz \right)}{\phi} \\
  \ip{\fd \ell D}{\phi} &= \ip{\rho_0 (1+b) \left( \frac{1}{2}|\vec u^\flat|^2 + \vec u \cdot \vec R - gz \right) - p}{\phi}.
\end{align*}
These can now be plugged into Equation \eqref{eq:ep_ad_two}. We then get,
\begin{align*}
  \rho_0 D(1 + b)\pdt (\vec u^\flat + \vec R) &+ \rho_0 D(1 + b)\pounds_{\vec u} (\vec u^\flat + \vec R) + D\left(\frac{1}{2}|\vec u^\flat|^2 + \vec u^\flat \cdot \vec R - gz\right) \diamond b \\
  &+ (1+ b)\left(\frac{1}{2}|\vec u^\flat|^2 + \vec u^\flat \cdot \vec R - gz - p\right) \diamond D = 0.
\end{align*}
This isn't very manageable, so we can simplify and put this equation back into coordinates. This leaves us with,
\begin{equation}
  \pd {[\vec u^\flat]} t + \pounds_{\vec u} [\vec u^\flat] + \pounds_{\vec u} \vec R - g\vec {\hat z} + B([\vec u^\flat],\, b,\, D,\, p) = 0.\label{eq:ree}
\end{equation}
We note that $B$ is our buoyancy and density gradient term and is defined by,
$$ B([\vec u^\flat],\, b,\, D,\, p) = \frac{D}{\rho_0}\left[ \frac{\left( \frac{1}{2}|[\vec u^\flat]|^2 + [\vec u^\flat] \cdot \vec R - gz \right)\diamond b}{D(1 + b)} + \frac{\left( \frac{1}{2}|[\vec u^\flat]|^2 + [\vec u^\flat] \cdot \vec R - gz - p \right)\diamond D}{D^2} \right]. $$

\noindent
Now we take Equation \eqref{eq:ree}, then we can place this into coordinates and remove the cosets,
$$ \pd {\vec u} t + ({\vec u} \cdot \nab) {\vec u} + {\vec u} \cdot \tcurl {\vec u} - g\vec{\hat z} + \frac{\nab p}{\rho_0} + B(\vec u,\, b,\, D,\, p) = 0. $$
This is the coordinated rotating stratified Euler equations with buoyancy term, where we advect density and buoyancy,
$$ \left(\pdt + D \cdot\nab\right) D  = \left(\pdt + b \cdot\nab\right) b = 0. $$

\noindent
For these equations, we have the usual conserved quantities, and Noether Theorem tells us that,
$$ \oint_{\g} \frac{1}{D}\fd \ell {\vec u} = \oint_{\g} \rho_0 (1 + b)(\vec u + \vec R)  = \oint_{\g} \nab p \cdot \dd \vec x. $$
Further, the advection equation for $b$ gives us potential vorticity conservation given $q = \nab b \cdot \tcurl(\vec u + \vec R)$. This is another well known consequence of Ertel's theorem. This time vorticity is,
$$ \dit \int_M \left( \pdt + \pounds_{\vec u} \right)\left( \tcurl\left((1 + b)(\vec u + R)\right) \cdot\dd S \right) = 0. $$
Further we have an idea of Helicity,
$$ \dit \int_M (1 + b)(\vec u + R) \cdot \tcurl \left( (1 + b)(\vec u + R) \right) = 0. $$